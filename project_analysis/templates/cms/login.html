<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin登录</title>
    <link rel="stylesheet" href="/static/common/bootstrap/css/bootstrap.min.css">
    <script src="/static/common/jquery.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='common/sweetalert2/sweetalert2.min.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='common/sweetalert2/sweetalert2.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='common/sweetalert2/promise.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='common/sweetalert2/xtalert.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='common/xtajax.js') }}"></script>
</head>
<body>

<div style="background: url(/static/common/images/bg.jpg) 100% 100%; position: absolute; top: 0; bottom: 0; left: 0; right: 0;"></div>

<div class="container-fluid ">
    <div class="row d-flex justify-content-center">
        <div class="col-md-6 col-lg-4">
            <div class="list-goup" style="margin-top: 20%; border-radius: 5px;">
                <div class="list-group-item text-info d-flex justify-content-between align-items-center">
                    <h3 style="margin: 0">LOGIN</h3>
                    <div>
                        <svg viewBox="0 0 1122 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M1081.663368 571.919244a95.842577 95.842577 0 0 1 32.230784-71.684664 26.03956 26.03956 0 0 0 5.341449-32.473577l-44.249043-76.297733a25.614672 25.614672 0 0 0-29.92425-11.59337 99.302379 99.302379 0 0 1-30.349138 4.673767 97.784922 97.784922 0 0 1-95.903275-76.297733 25.675371 25.675371 0 0 0-25.068388-20.333922H806.153895a25.675371 25.675371 0 0 0-25.068387 20.333922 97.784922 97.784922 0 0 1-95.903276 76.297733 99.302379 99.302379 0 0 1-30.349138-4.673767 25.553974 25.553974 0 0 0-29.56006 11.59337L580.902595 467.457511a26.100258 26.100258 0 0 0 5.341448 32.534276 95.781879 95.781879 0 0 1 0 143.369327 26.03956 26.03956 0 0 0-5.341448 32.473577l44.370439 76.540526a25.553974 25.553974 0 0 0 29.92425 11.59337 99.302379 99.302379 0 0 1 30.349138-4.673767 97.784922 97.784922 0 0 1 95.903275 76.297733 25.675371 25.675371 0 0 0 24.704198 20.333922h87.769707a25.675371 25.675371 0 0 0 25.068388-20.333922 97.784922 97.784922 0 0 1 95.903275-76.297733 99.302379 99.302379 0 0 1 30.349138 4.673767 25.614672 25.614672 0 0 0 29.92425-11.59337l44.249043-76.237034a26.100258 26.100258 0 0 0-5.341449-32.534276 95.781879 95.781879 0 0 1-32.412879-71.684663z m-17.723896 86.434344l-30.713328 52.200517a132.079448 132.079448 0 0 0-78.907758 6.616112 128.983836 128.983836 0 0 0-41.032034 26.889336 126.00962 126.00962 0 0 0-32.412879 52.44331H819.507516a126.00962 126.00962 0 0 0-32.412879-52.382612 128.923137 128.923137 0 0 0-41.032034-26.950034 132.018749 132.018749 0 0 0-78.907759-6.616112l-30.713327-52.139819a126.980792 126.980792 0 0 0 16.631327-21.669284A124.552861 124.552861 0 0 0 636.198724 485.666994l30.713327-52.200517a132.079448 132.079448 0 0 0 78.907758-6.616112 128.983836 128.983836 0 0 0 41.032035-26.889336 126.00962 126.00962 0 0 0 32.655672-52.564707h61.305258a126.00962 126.00962 0 0 0 32.412879 52.382612 128.741042 128.741042 0 0 0 41.032035 26.950034 132.079448 132.079448 0 0 0 78.907758 6.616112l30.713327 52.321914a127.466379 127.466379 0 0 0-16.631327 21.669284 124.552861 124.552861 0 0 0 16.631327 151.01731z" p-id="5561" fill="#17a2b8"></path><path d="M849.856654 464.361899a113.627172 113.627172 0 1 0 113.566473 113.566474A113.627172 113.627172 0 0 0 849.856654 464.361899z m47.769543 160.911129a67.314388 67.314388 0 1 1 19.726939-47.587448 66.768103 66.768103 0 0 1-19.726939 47.587448z" p-id="5562" fill="#17a2b8"></path><path d="M66.424011 66.424005V757.595269h466.709041c27.253526 0 45.463008 6.069828 45.463008 33.141258s-12.139655 33.141258-39.332482 33.141258H45.543804A42.913681 42.913681 0 0 1 0.080796 778.536174V45.543798A42.913681 42.913681 0 0 1 45.543804 0.080789h993.630771c27.253526 0 39.332483 18.209483 39.332483 45.463009v233.324171c0 27.253526-6.069828 45.463008-33.141259 45.463009s-33.141258-27.253526-33.141258-45.463009v-212.443964zM339.323458 1024c-27.253526 0-45.463008-12.139655-45.463008-39.393181s18.209483-39.393181 45.463008-39.393181h408.984981c27.253526 0 45.463008 12.139655 45.463008 39.393181s-18.209483 39.393181-45.463008 39.393181z" p-id="5563" fill="#17a2b8"></path><path d="M180.961657 362.874382l-30.349138-38.786198 172.018913-108.225025 141.973267 91.836491 146.647033-94.871405-0.849775 53.839371L464.665397 363.056477 322.752829 271.159288 180.961657 362.874382zM180.961657 600.811623l-30.349138-38.846897 172.018913-108.225025 141.973267 91.897189 2.063741 1.213966-1.274664 54.567749-142.640947-92.322077L180.961657 600.811623z" p-id="5564" fill="#17a2b8"></path></svg>
                    </div>
                </div>
                <div class="list-group-item">

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">账户名:</span>
                        </div>
                        <input type="text" class="form-control" id="login_account" placeholder="请输入账户名" aria-label="">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">密 码：</span>
                        </div>
                        <input type="password" class="form-control" placeholder="密码" id="password" aria-label="">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">验证码:</span>
                        </div>
                        <input type="text" class="form-control" id="graph_captcha" placeholder="验证码" aria-label="" aria-describedby="">
                        <div class="input-group-append">
                            <span class="input-group-text p-0">
                                <img class="input-group-text p-0" id="imgCapBtn" style="width: 100%; height: 100%; display: block; border: none; cursor: pointer;" src="{{ img_cap }}" alt="">
                            </span>
                        </div>
                    </div>

                    <div class="form-group mt-4">
                        <button class="btn btn-success btn-block btn-lg" id="loginBtn">登 录</button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script>

    // 页面刷新
    function reloadpage(redi_url,seconds) {
        let redirect_url = redi_url;
        let delay_seconds = seconds;
        if(redi_url=='' || typeof(redi_url)=='undefined' || redi_url=='undefined'){redirect_url = window.location.href}
        if(seconds=='' || typeof(seconds)=='undefined' || seconds=='undefined'){delay_seconds = 1000}
        setTimeout(function (){window.location.assign(redirect_url);},delay_seconds)
    }

    $(function () {
        $("#imgCapBtn").on('click', function () {
            xtajax.get({
                'url':'{{ url_for('common.img_cap') }}',
                'success': function (data) {
                    $('#imgCapBtn').attr('src', data);
                }
            })
        })
    
        $("#loginBtn").on('click', function () {
            let login_account = $.trim($("#login_account").val())
            let password = $.trim($("#password").val())
            let graph_captcha = $.trim($("#graph_captcha").val())
            if (!login_account){return xtalert.alertError('请输入登录账户！')}
            if (!password){return  xtalert.alertError('请输入登录密码！')}
            if (!graph_captcha){return xtalert.alertError('请输入验证码！')}
            Swal({
                title: false,
                text: '数据提交中...',
                showCloseButton: false,
                showCancelButton: false,
                showconfirmButton: false,
                allowOutsideClick: false,
                onBeforeOpen: () => {
                    Swal.showLoading()
                }
            });
            xtajax.post({
                data: {'action': 'pwdLogin', 'login_account': login_account, 'password': password, 'graph_captcha': graph_captcha},
                success: function (data) {
                    if (data.code === 200){
                        xtalert.alertSuccessToast('登录成功！');
                        reloadpage('/site_admin');
                    }else {
                        xtalert.alertErrorToast(data.message)
                    }
                }
            })

        })
    })

</script>

</body>
</html>